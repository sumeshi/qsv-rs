import unittest
from test_base import QsvTestBase

class TestStats(QsvTestBase):
    
    def test_stats_basic(self):
        """Test basic stats functionality"""
        self.assertTrue(
            self.run_qsv_command(f"load {self.get_fixture_path('simple.csv')} - stats").stdout.strip(),
            "\n".join([
                "┌──────────────┬─────────────────────┬────────┬────────┬────────┬─────┐",
                "│ Statistic    ┆ datetime            ┆ col1   ┆ col2   ┆ col3   ┆ str │",
                "╞══════════════╪═════════════════════╪════════╪════════╪════════╪═════╡",
                "│ count        ┆ 3                   ┆ 3      ┆ 3      ┆ 3      ┆ 3   │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ null_count   ┆ 0                   ┆ 0      ┆ 0      ┆ 0      ┆ 0   │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ datatype     ┆ str                 ┆ i64    ┆ i64    ┆ i64    ┆ str │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ mean         ┆ -                   ┆ 4.0000 ┆ 5.0000 ┆ 6.0000 ┆ -   │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ std          ┆ -                   ┆ 3.0000 ┆ 3.0000 ┆ 3.0000 ┆ -   │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ min          ┆ 2023-01-01 12:00:00 ┆ 1      ┆ 2      ┆ 3      ┆ bar │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ 25%          ┆ -                   ┆ 2.5000 ┆ 3.5000 ┆ 4.5000 ┆ -   │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ 50% (median) ┆ -                   ┆ 4.0000 ┆ 5.0000 ┆ 6.0000 ┆ -   │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ 75%          ┆ -                   ┆ 5.5000 ┆ 6.5000 ┆ 7.5000 ┆ -   │",
                "├╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┤",
                "│ max          ┆ 2023-01-01 14:00:00 ┆ 7      ┆ 8      ┆ 9      ┆ foo │",
                "└──────────────┴─────────────────────┴────────┴────────┴────────┴─────┘",
            ])
        )

if __name__ == "__main__":
    unittest.main() 